2025-11-20 17:39:17,458 - INFO - Loading dataset from: data/emergencias.csv
2025-11-20 17:39:17,670 - INFO - Dataset loaded: 281 records (removed 219 duplicates/nulls)
2025-11-20 17:39:17,693 - INFO - Classes detected: ['desastre_natural', 'incendio', 'violencia', 'intoxicacion', 'accidente', 'medica', 'crisis_emocional', 'otra']
2025-11-20 17:39:17,699 - INFO - Class distribution:
clase_emergencia
otra                44
desastre_natural    42
incendio            39
violencia           38
accidente           37
intoxicacion        33
medica              29
crisis_emocional    19
2025-11-20 17:39:17,809 - INFO - ================================================================================
2025-11-20 17:39:17,889 - INFO - TRAINING PIPELINE STARTED
2025-11-20 17:39:17,899 - INFO - ================================================================================
2025-11-20 17:39:18,063 - INFO - Data split - Train: 224, Test: 57
2025-11-20 17:39:18,650 - INFO - Vectorization complete - Features: 438
2025-11-20 17:39:18,915 - INFO - Starting hyperparameter optimization...
2025-11-20 17:43:53,232 - INFO - Best parameters found: {'max_depth': 20, 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 150}
2025-11-20 17:43:53,234 - INFO - Best cross-validation score: 0.8541
2025-11-20 17:43:53,236 - INFO - Evaluating model performance...
2025-11-20 17:43:53,622 - INFO - PERFORMANCE METRICS:
2025-11-20 17:43:53,624 - INFO -   Train Accuracy: 0.9643
2025-11-20 17:43:53,648 - INFO -   Test Accuracy:  0.9123
2025-11-20 17:43:53,655 - INFO -   Precision:      0.9340
2025-11-20 17:43:53,661 - INFO -   Recall:         0.9123
2025-11-20 17:43:53,663 - INFO -   F1-Score:       0.9140
2025-11-20 17:43:53,663 - INFO -   MCC:            0.9022
2025-11-20 17:43:53,664 - INFO - 
CLASSIFICATION REPORT:
2025-11-20 17:43:53,706 - INFO - 
                  precision    recall  f1-score   support

       accidente       1.00      0.71      0.83         7
crisis_emocional       1.00      1.00      1.00         4
desastre_natural       1.00      0.88      0.93         8
        incendio       0.89      1.00      0.94         8
    intoxicacion       0.88      1.00      0.93         7
          medica       0.67      1.00      0.80         6
            otra       1.00      0.89      0.94         9
       violencia       1.00      0.88      0.93         8

        accuracy                           0.91        57
       macro avg       0.93      0.92      0.91        57
    weighted avg       0.93      0.91      0.91        57

2025-11-20 17:43:53,740 - INFO - 
CONFUSION MATRIX:
2025-11-20 17:43:53,751 - INFO - 
[[5 0 0 0 1 1 0 0]
 [0 4 0 0 0 0 0 0]
 [0 0 7 0 0 1 0 0]
 [0 0 0 8 0 0 0 0]
 [0 0 0 0 7 0 0 0]
 [0 0 0 0 0 6 0 0]
 [0 0 0 0 0 1 8 0]
 [0 0 0 1 0 0 0 7]]
2025-11-20 17:43:54,041 - INFO - 
TOP 20 MOST IMPORTANT FEATURES:
2025-11-20 17:43:54,043 - INFO -    1. incendio             0.042761
2025-11-20 17:43:54,043 - INFO -    2. intoxicacion         0.028725
2025-11-20 17:43:54,044 - INFO -    3. fuego                0.026589
2025-11-20 17:43:54,045 - INFO -    4. llamas               0.026048
2025-11-20 17:43:54,046 - INFO -    5. panico               0.023925
2025-11-20 17:43:54,047 - INFO -    6. violencia            0.020049
2025-11-20 17:43:54,047 - INFO -    7. lluvias              0.019683
2025-11-20 17:43:54,051 - INFO -    8. despues              0.019301
2025-11-20 17:43:54,052 - INFO -    9. asalto               0.019118
2025-11-20 17:43:54,062 - INFO -   10. las lluvias          0.018886
2025-11-20 17:43:54,065 - INFO -   11. ansiedad             0.017863
2025-11-20 17:43:54,066 - INFO -   12. pensamientos         0.016555
2025-11-20 17:43:54,066 - INFO -   13. las                  0.015970
2025-11-20 17:43:54,067 - INFO -   14. luz                  0.015547
2025-11-20 17:43:54,068 - INFO -   15. ataque panico        0.013618
2025-11-20 17:43:54,069 - INFO -   16. ataque               0.013362
2025-11-20 17:43:54,080 - INFO -   17. inundacion           0.012404
2025-11-20 17:43:54,083 - INFO -   18. huele fuerte         0.012000
2025-11-20 17:43:54,083 - INFO -   19. fuga                 0.011316
2025-11-20 17:43:54,084 - INFO -   20. medicamento          0.011038
2025-11-20 17:43:54,085 - INFO - ================================================================================
2025-11-20 17:43:54,093 - INFO - TRAINING COMPLETED SUCCESSFULLY
2025-11-20 17:43:54,096 - INFO - ================================================================================
2025-11-20 17:43:54,100 - INFO - Saving model artifacts...
2025-11-20 17:43:54,455 - INFO - Model saved to: models/agentcore_production.joblib
2025-11-20 17:43:54,457 - INFO - Vectorizer saved to: models/agentcore_vectorizer.joblib
2025-11-20 17:43:54,459 - INFO - Label encoder saved to: models/agentcore_encoder.joblib
2025-11-20 17:43:54,461 - INFO - Metrics saved to: models/training_metrics.json
2025-11-20 17:43:54,462 - INFO - Pipeline completed successfully
